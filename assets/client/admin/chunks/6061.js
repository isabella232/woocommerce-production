"use strict";(self.webpackChunk_wcAdmin_webpackJsonp=self.webpackChunk_wcAdmin_webpackJsonp||[]).push([[6061],{98344:function(e,t,o){o.d(t,{IO:function(){return w},Yt:function(){return g}});var n=o(5267),s=o(69307),r=o(65736),i=o(67221),a=o(22629),c=o(92819),l=o(86020),d=o(55609),u=o(9818);const m=["addressLine1","addressLine2","city","countryState","postCode"];function p(e){var t;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return null!==(t=o[e])&&void 0!==t&&t.hasOwnProperty("required")?null===(n=o[e])||void 0===n?void 0:n.required:"address_2"!==e}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>{const o={};return p("address_1",e)&&!t.addressLine1.trim().length&&(o.addressLine1=(0,r.__)("Please add an address","woocommerce-admin")),t.countryState.trim().length||(o.countryState=(0,r.__)("Please select a country / region","woocommerce-admin")),p("city",e)&&!t.city.trim().length&&(o.city=(0,r.__)("Please add a city","woocommerce-admin")),p("postcode",e)&&!t.postCode.trim().length&&(o.postCode=(0,r.__)("Please add a post code","woocommerce-admin")),o}}const _=e=>e.replace(/\s/g,"").toLowerCase(),h=(e,t)=>o=>{const n=e?o.key.split(":"):o.label.split("—");if(n.length<=1)return!1;const s=n[1];if(s.includes("/")){const e=s.split("/");return _(e[0])===t||_(e[1])===t}if(s.includes("(")&&s.includes(")")){const e=s.replace(")","").split("(");return _(e[0])===t||_(e[1])===t}return _(s)===t};function w(e){var t,o,g,w,f,y,v,C;let{getInputProps:k,setValue:E}=e;const S=k("countryState").value,{locale:b,hasFinishedResolution:T,countries:R,loadingCountries:O}=(0,u.useSelect)((e=>{const{getLocale:t,getCountries:o,hasFinishedResolution:n}=e(i.COUNTRIES_STORE_NAME);return{locale:t(S),countries:o(),loadingCountries:!n("getCountries"),hasFinishedResolution:n("getLocales")}})),L=(0,s.useMemo)((()=>function(e){return e.reduce(((e,t)=>{if(!t.states.length)return e.push({key:t.code,label:(0,a.decodeEntities)(t.name)}),e;const o=t.states.map((e=>({key:t.code+":"+e.code,label:(0,a.decodeEntities)(t.name)+" — "+(0,a.decodeEntities)(e.name)})));return e.push(...o),e}),[])}(R)),[R]),N=function(e,t,o){const[n,r]=(0,s.useState)(""),[i,a]=(0,s.useState)(""),l=(0,s.useRef)();return(0,s.useEffect)((()=>{if(!l.current){const o=e.find((e=>e.key===t)),s=o?o.label.split(/\u2013|\u2014|\-/):[],c=(s[0]||"").trim(),l=(s[1]||"").trim();c===n&&l===i||(r(c),a(l))}l.current=!1}),[t,e]),(0,s.useEffect)((()=>{if(void 0===l.current)return;if(!n&&!i&&t)return l.current=!0,void o("countryState","");const s=new RegExp((0,c.escapeRegExp)(n),"i"),r=n.length<3,a=i.length<3&&!!i.match(/^[\w]+$/);let d=[];n.length&&i.length?(d=e.filter((e=>s.test(r?e.key:e.label))),d.length||(d=[...e]),d.length>1&&(d=d.filter(h(a,_(i))))):n.length?d=e.filter((e=>s.test(r?e.key:e.label))):i.length&&(d=e.filter(h(a,_(i)))),1===d.length&&t!==d[0].key&&(l.current=!0,o("countryState",d[0].key))}),[n,i,e,o]),(0,s.createElement)(s.Fragment,null,(0,s.createElement)("input",{onChange:e=>r(e.target.value),value:n,name:"country",type:"text",className:"woocommerce-select-control__autofill-input",tabIndex:-1,autoComplete:"country"}),(0,s.createElement)("input",{onChange:e=>a(e.target.value),value:i,name:"state",type:"text",className:"woocommerce-select-control__autofill-input",tabIndex:-1,autoComplete:"address-level1"}))}(L,S,E);return(0,s.useEffect)((()=>{b&&m.forEach((e=>{var t,o;const n=e.replace(/(address)Line([0-9])/,"$1$2").toLowerCase(),s=k(e);null!==(t=b[n])&&void 0!==t&&t.hidden&&(null===(o=s.value)||void 0===o?void 0:o.length)>0&&E(e,"")}))}),[S,b]),!T||O?(0,s.createElement)(d.Spinner,null):(0,s.createElement)("div",{className:"woocommerce-store-address-fields"},!(null!=b&&null!==(t=b.address_1)&&void 0!==t&&t.hidden)&&(0,s.createElement)(l.TextControl,(0,n.Z)({label:(null==b||null===(o=b.address_1)||void 0===o?void 0:o.label)||(0,r.__)("Address line 1","woocommerce-admin"),required:p("address_1",b),autoComplete:"address-line1"},k("addressLine1"))),!(null!=b&&null!==(g=b.address_2)&&void 0!==g&&g.hidden)&&(0,s.createElement)(l.TextControl,(0,n.Z)({label:(null==b||null===(w=b.address_2)||void 0===w?void 0:w.label)||(0,r.__)("Address line 2 (optional)","woocommerce-admin"),required:p("address_2",b),autoComplete:"address-line2"},k("addressLine2"))),(0,s.createElement)(l.SelectControl,(0,n.Z)({label:(0,r.__)("Country / Region","woocommerce-admin"),required:!0,autoComplete:"new-password",options:L,excludeSelectedOptions:!1,showAllOnFocus:!0,isSearchable:!0},k("countryState"),{controlClassName:k("countryState").className}),N),!(null!=b&&null!==(f=b.city)&&void 0!==f&&f.hidden)&&(0,s.createElement)(l.TextControl,(0,n.Z)({label:(null==b||null===(y=b.city)||void 0===y?void 0:y.label)||(0,r.__)("City","woocommerce-admin"),required:p("city",b)},k("city"),{autoComplete:"address-level2"})),!(null!=b&&null!==(v=b.postcode)&&void 0!==v&&v.hidden)&&(0,s.createElement)(l.TextControl,(0,n.Z)({label:(null==b||null===(C=b.postcode)||void 0===C?void 0:C.label)||(0,r.__)("Post code","woocommerce-admin"),required:p("postcode",b),autoComplete:"postal-code"},k("postCode"))))}},79811:function(e,t,o){o.d(t,{$:function(){return d},s:function(){return l}});var n=o(69307),s=o(92694),r=o(17844),i=o.n(r),a=o(4411);const c=i()(a.wA),l=e=>{const t=c.getCurrencyConfig(),o=(0,s.applyFilters)("woocommerce_admin_report_currency",t,e);return i()(o)},d=(0,n.createContext)(c)},64329:function(e,t,o){o.d(t,{a:function(){return s}});var n=o(9818);function s(e){const{createNotice:t}=(0,n.dispatch)("core/notices");e.error_data&&e.errors&&Object.keys(e.errors).length?Object.keys(e.errors).forEach((o=>{t("error",e.errors[o].join(" "))})):e.message&&t(e.code?"error":"success",e.message)}},96862:function(e,t,o){var n=o(74944);const s=["a","b","em","i","strong","p","br"],r=["target","href","rel","name","download"];t.ZP=e=>({__html:(0,n.sanitize)(e,{ALLOWED_TAGS:s,ALLOWED_ATTR:r})})},59868:function(e,t,o){var n=o(69307),s=o(65736),r=o(94333),i=o(9818),a=o(29497),c=o(55609),l=o(86020),d=o(67221),u=o(73516);class m extends n.Component{constructor(e){super(e),this.state={isLoadingScripts:!1,isRequestStarted:!1}}async componentDidUpdate(e,t){const{hasErrors:o,isRequesting:n,onClose:r,onContinue:i,createNotice:a}=this.props,{isLoadingScripts:c,isRequestStarted:l}=this.state;if(!l)return;const d=!n&&!c&&(e.isRequesting||t.isLoadingScripts)&&!o,u=!n&&e.isRequesting&&o;d&&(r(),i()),u&&(a("error",(0,s.__)("There was a problem updating your preferences","woocommerce-admin")),r())}updateTracking(e){let{allowTracking:t}=e;const{updateOptions:o}=this.props;t&&"function"==typeof window.wcTracks.enable?(this.setState({isLoadingScripts:!0}),window.wcTracks.enable((()=>{this._isMounted&&((0,u.initializeExPlat)(),this.setState({isLoadingScripts:!1}))}))):t||(window.wcTracks.isEnabled=!1);const n=t?"yes":"no";this.setState({isRequestStarted:!0}),o({woocommerce_allow_tracking:n})}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{allowTracking:e,isResolving:t,onClose:o,onContinue:r}=this.props;if(t)return null;if(e)return o(),r(),null;const{isRequesting:i,title:d=(0,s.__)("Build a better WooCommerce","woocommerce-admin"),message:u=(0,a.Z)({mixedString:(0,s.__)("Get improved features and faster fixes by sharing non-sensitive data via {{link}}usage tracking{{/link}} that shows us how WooCommerce is used. No personal data is tracked or stored.","woocommerce-admin"),components:{link:(0,n.createElement)(l.Link,{href:"https://woocommerce.com/usage-tracking?utm_medium=product",target:"_blank",type:"external"})}}),dismissActionText:m=(0,s.__)("No thanks","woocommerce-admin"),acceptActionText:p=(0,s.__)("Yes, count me in!","woocommerce-admin")}=this.props,{isRequestStarted:g}=this.state,_=g&&i;return(0,n.createElement)(c.Modal,{title:d,isDismissible:this.props.isDismissible,onRequestClose:()=>this.props.onClose(),className:"woocommerce-usage-modal"},(0,n.createElement)("div",{className:"woocommerce-usage-modal__wrapper"},(0,n.createElement)("div",{className:"woocommerce-usage-modal__message"},u),(0,n.createElement)("div",{className:"woocommerce-usage-modal__actions"},(0,n.createElement)(c.Button,{isSecondary:!0,isBusy:_,onClick:()=>this.updateTracking({allowTracking:!1})},m),(0,n.createElement)(c.Button,{isPrimary:!0,isBusy:_,onClick:()=>this.updateTracking({allowTracking:!0})},p))))}}t.Z=(0,r.compose)((0,i.withSelect)((e=>{const{getOption:t,getOptionsUpdatingError:o,isOptionsUpdating:n,hasFinishedResolution:s}=e(d.OPTIONS_STORE_NAME);return{allowTracking:"yes"===t("woocommerce_allow_tracking"),isRequesting:Boolean(n()),isResolving:!s("getOption",["woocommerce_allow_tracking"])||void 0===t("woocommerce_allow_tracking"),hasErrors:Boolean(o())}})),(0,i.withDispatch)((e=>{const{createNotice:t}=e("core/notices"),{updateOptions:o}=e(d.OPTIONS_STORE_NAME);return{createNotice:t,updateOptions:o}})))(m)},462:function(e,t,o){function n(e){return(e||"").split(":",1)[0]}function s(e){const t=n(e);return/^woocommerce(-|_)payments$/.test(t)?"wcpay":`${t.replace(/-/g,"_")}`.split(":",1)[0]}o.d(t,{V:function(){return n},b:function(){return s}})}}]);