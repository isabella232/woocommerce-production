"use strict";(self.webpackChunk_wcAdmin_webpackJsonp=self.webpackChunk_wcAdmin_webpackJsonp||[]).push([[5487],{23961:function(e,t,r){r.d(t,{Z:function(){return w}});var o=r(69307),a=r(65736),n=r(94333),i=r(69771),l=r(9818),c=r(92819),m=r(7862),s=r.n(m),d=r(86020),u=r(67221),p=r(81921),_=r(83199),f=r(46439),y=r(10431);function g(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||0===e.length)return null;const o=e.slice(0),a=o.pop();if(a.showFilters(t,r)){const e=(0,y.flattenFilters)(a.filters),r=t[a.param]||a.defaultValue||"all";return(0,c.find)(e,{value:r})}return g(o,t,r)}function h(e){return t=>(0,i.format)(e,t)}class b extends o.Component{shouldComponentUpdate(e){return e.isRequesting!==this.props.isRequesting||e.primaryData.isRequesting!==this.props.primaryData.isRequesting||e.secondaryData.isRequesting!==this.props.secondaryData.isRequesting||!(0,c.isEqual)(e.query,this.props.query)}getItemChartData(){const{primaryData:e,selectedChart:t}=this.props;return e.data.intervals.map((function(e){const r={};return e.subtotals.segments.forEach((function(e){if(e.segment_label){const o=r[e.segment_label]?e.segment_label+" (#"+e.segment_id+")":e.segment_label;r[e.segment_id]={label:o,value:e.subtotals[t.key]||0}}})),{date:(0,i.format)("Y-m-d\\TH:i:s",e.date_start),...r}}))}getTimeChartData(){const{query:e,primaryData:t,secondaryData:r,selectedChart:o,defaultDateRange:a}=this.props,n=(0,p.getIntervalForQuery)(e,a),{primary:l,secondary:c}=(0,p.getCurrentDates)(e,a);return t.data.intervals.map((function(t,a){const m=(0,p.getPreviousDate)(t.date_start,l.after,c.after,e.compare,n),s=r.data.intervals[a];return{date:(0,i.format)("Y-m-d\\TH:i:s",t.date_start),primary:{label:`${l.label} (${l.range})`,labelDate:t.date_start,value:t.subtotals[o.key]||0},secondary:{label:`${c.label} (${c.range})`,labelDate:m.format("YYYY-MM-DD HH:mm:ss"),value:s&&s.subtotals[o.key]||0}}}))}getTimeChartTotals(){const{primaryData:e,secondaryData:t,selectedChart:r}=this.props;return{primary:(0,c.get)(e,["data","totals",r.key],null),secondary:(0,c.get)(t,["data","totals",r.key],null)}}renderChart(e,t,r,n){const{emptySearchResults:i,filterParam:l,interactiveLegend:c,itemsLabel:m,legendPosition:s,path:_,query:f,selectedChart:y,showHeaderControls:g,primaryData:b,defaultDateRange:w}=this.props,v=(0,p.getIntervalForQuery)(f,w),C=(0,p.getAllowedIntervalsForQuery)(f,w),S=(0,p.getDateFormatsForInterval)(v,b.data.intervals.length,{type:"php"}),R=i?(0,a.__)("No data for the current search","woocommerce-admin"):(0,a.__)("No data for the selected date range","woocommerce-admin"),{formatAmount:x,getCurrencyConfig:D}=this.context;return(0,o.createElement)(d.Chart,{allowedIntervals:C,data:r,dateParser:"%Y-%m-%dT%H:%M:%S",emptyMessage:R,filterParam:l,interactiveLegend:c,interval:v,isRequesting:t,itemsLabel:m,legendPosition:s,legendTotals:n,mode:e,path:_,query:f,screenReaderFormat:h(S.screenReaderFormat),showHeaderControls:g,title:y.label,tooltipLabelFormat:h(S.tooltipLabelFormat),tooltipTitle:"time-comparison"===e&&y.label||null,tooltipValueFormat:(0,u.getTooltipValueFormat)(y.type,x),chartType:(0,p.getChartTypeForQuery)(f),valueType:y.type,xFormat:h(S.xFormat),x2Format:h(S.x2Format),currency:D()})}renderItemComparison(){const{isRequesting:e,primaryData:t}=this.props;if(t.isError)return(0,o.createElement)(f.Z,null);const r=e||t.isRequesting,a=this.getItemChartData();return this.renderChart("item-comparison",r,a)}renderTimeComparison(){const{isRequesting:e,primaryData:t,secondaryData:r}=this.props;if(!t||t.isError||r.isError)return(0,o.createElement)(f.Z,null);const a=e||t.isRequesting||r.isRequesting,n=this.getTimeChartData(),i=this.getTimeChartTotals();return this.renderChart("time-comparison",a,n,i)}render(){const{mode:e}=this.props;return"item-comparison"===e?this.renderItemComparison():this.renderTimeComparison()}}b.contextType=_.$,b.propTypes={filters:s().array,isRequesting:s().bool,itemsLabel:s().string,limitProperties:s().array,mode:s().string,path:s().string.isRequired,primaryData:s().object,query:s().object.isRequired,secondaryData:s().object,selectedChart:s().shape({key:s().string.isRequired,label:s().string.isRequired,order:s().oneOf(["asc","desc"]),orderby:s().string,type:s().oneOf(["average","number","currency"]).isRequired}).isRequired},b.defaultProps={isRequesting:!1,primaryData:{data:{intervals:[]},isError:!1,isRequesting:!1},secondaryData:{data:{intervals:[]},isError:!1,isRequesting:!1}};var w=(0,n.compose)((0,l.withSelect)(((e,t)=>{const{charts:r,endpoint:o,filters:a,isRequesting:n,limitProperties:i,query:l,advancedFilters:m}=t,s=i||[o],d=g(a,l),p=(0,c.get)(d,["settings","param"]),_=t.mode||function(e,t){if(e&&t){const r=(0,c.get)(e,["settings","param"]);if(!r||Object.keys(t).includes(r))return(0,c.get)(e,["chartMode"])}return null}(d,l)||"time-comparison",{woocommerce_default_date_range:f}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings"),y=e(u.REPORTS_STORE_NAME),h={mode:_,filterParam:p,defaultDateRange:f};if(n)return h;const b=s.some((e=>l[e]&&l[e].length));if(l.search&&!b)return{...h,emptySearchResults:!0};const w=r&&r.map((e=>e.key)),v=(0,u.getReportChartData)({endpoint:o,dataType:"primary",query:l,selector:y,limitBy:s,filters:a,advancedFilters:m,defaultDateRange:f,fields:w});if("item-comparison"===_)return{...h,primaryData:v};const C=(0,u.getReportChartData)({endpoint:o,dataType:"secondary",query:l,selector:y,limitBy:s,filters:a,advancedFilters:m,defaultDateRange:f,fields:w});return{...h,primaryData:v,secondaryData:C}})))(b)},7323:function(e,t,r){r.d(t,{O3:function(){return l},be:function(){return m},u8:function(){return c}});var o=r(65736),a=r(92694),n=r(63193),i=r(4411);const l=(0,a.applyFilters)("woocommerce_admin_orders_report_charts",[{key:"orders_count",label:(0,o.__)("Orders","woocommerce-admin"),type:"number"},{key:"net_revenue",label:(0,o.__)("Net sales","woocommerce-admin"),order:"desc",orderby:"net_total",type:"currency"},{key:"avg_order_value",label:(0,o.__)("Average order value","woocommerce-admin"),type:"currency"},{key:"avg_items_per_order",label:(0,o.__)("Average items per order","woocommerce-admin"),order:"desc",orderby:"num_items_sold",type:"average"}]),c=(0,a.applyFilters)("woocommerce_admin_orders_report_filters",[{label:(0,o.__)("Show","woocommerce-admin"),staticParams:["chartType","paged","per_page"],param:"filter",showFilters:()=>!0,filters:[{label:(0,o.__)("All orders","woocommerce-admin"),value:"all"},{label:(0,o.__)("Advanced filters","woocommerce-admin"),value:"advanced"}]}]),m=(0,a.applyFilters)("woocommerce_admin_orders_report_advanced_filters",{title:(0,o._x)("Orders match {{select /}} filters","A sentence describing filters for Orders. See screen shot for context: https://cloudup.com/cSsUY9VeCVJ","woocommerce-admin"),filters:{status:{labels:{add:(0,o.__)("Order Status","woocommerce-admin"),remove:(0,o.__)("Remove order status filter","woocommerce-admin"),rule:(0,o.__)("Select an order status filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Order Status{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select an order status","woocommerce-admin")},rules:[{value:"is",label:(0,o._x)("Is","order status","woocommerce-admin")},{value:"is_not",label:(0,o._x)("Is Not","order status","woocommerce-admin")}],input:{component:"SelectControl",options:Object.keys(i.rq).map((e=>({value:e,label:i.rq[e]})))}},product:{labels:{add:(0,o.__)("Products","woocommerce-admin"),placeholder:(0,o.__)("Search products","woocommerce-admin"),remove:(0,o.__)("Remove products filter","woocommerce-admin"),rule:(0,o.__)("Select a product filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Product{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select products","woocommerce-admin")},rules:[{value:"includes",label:(0,o._x)("Includes","products","woocommerce-admin")},{value:"excludes",label:(0,o._x)("Excludes","products","woocommerce-admin")}],input:{component:"Search",type:"products",getLabels:n.oC}},variation:{labels:{add:(0,o.__)("Variations","woocommerce-admin"),placeholder:(0,o.__)("Search variations","woocommerce-admin"),remove:(0,o.__)("Remove variations filter","woocommerce-admin"),rule:(0,o.__)("Select a variation filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Variation{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select variation","woocommerce-admin")},rules:[{value:"includes",label:(0,o._x)("Includes","variations","woocommerce-admin")},{value:"excludes",label:(0,o._x)("Excludes","variations","woocommerce-admin")}],input:{component:"Search",type:"variations",getLabels:n.uC}},coupon:{labels:{add:(0,o.__)("Coupon Codes","woocommerce-admin"),placeholder:(0,o.__)("Search coupons","woocommerce-admin"),remove:(0,o.__)("Remove coupon filter","woocommerce-admin"),rule:(0,o.__)("Select a coupon filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Coupon code{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select coupon codes","woocommerce-admin")},rules:[{value:"includes",label:(0,o._x)("Includes","coupon code","woocommerce-admin")},{value:"excludes",label:(0,o._x)("Excludes","coupon code","woocommerce-admin")}],input:{component:"Search",type:"coupons",getLabels:n.hQ}},customer_type:{labels:{add:(0,o.__)("Customer type","woocommerce-admin"),remove:(0,o.__)("Remove customer filter","woocommerce-admin"),rule:(0,o.__)("Select a customer filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Customer is{{/title}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select a customer type","woocommerce-admin")},input:{component:"SelectControl",options:[{value:"new",label:(0,o.__)("New","woocommerce-admin")},{value:"returning",label:(0,o.__)("Returning","woocommerce-admin")}],defaultOption:"new"}},refunds:{labels:{add:(0,o.__)("Refunds","woocommerce-admin"),remove:(0,o.__)("Remove refunds filter","woocommerce-admin"),rule:(0,o.__)("Select a refund filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Refunds{{/title}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select a refund type","woocommerce-admin")},input:{component:"SelectControl",options:[{value:"all",label:(0,o.__)("All","woocommerce-admin")},{value:"partial",label:(0,o.__)("Partially refunded","woocommerce-admin")},{value:"full",label:(0,o.__)("Fully refunded","woocommerce-admin")},{value:"none",label:(0,o.__)("None","woocommerce-admin")}],defaultOption:"all"}},tax_rate:{labels:{add:(0,o.__)("Tax Rates","woocommerce-admin"),placeholder:(0,o.__)("Search tax rates","woocommerce-admin"),remove:(0,o.__)("Remove tax rate filter","woocommerce-admin"),rule:(0,o.__)("Select a tax rate filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Tax Rate{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select tax rates","woocommerce-admin")},rules:[{value:"includes",label:(0,o._x)("Includes","tax rate","woocommerce-admin")},{value:"excludes",label:(0,o._x)("Excludes","tax rate","woocommerce-admin")}],input:{component:"Search",type:"taxes",getLabels:n.FI}},attribute:{allowMultiple:!0,labels:{add:(0,o.__)("Attribute","woocommerce-admin"),placeholder:(0,o.__)("Search attributes","woocommerce-admin"),remove:(0,o.__)("Remove attribute filter","woocommerce-admin"),rule:(0,o.__)("Select a product attribute filter match","woocommerce-admin"),title:(0,o.__)("{{title}}Attribute{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,o.__)("Select attributes","woocommerce-admin")},rules:[{value:"is",label:(0,o._x)("Is","product attribute","woocommerce-admin")},{value:"is_not",label:(0,o._x)("Is Not","product attribute","woocommerce-admin")}],input:{component:"ProductAttribute"}}}})},61681:function(e,t,r){r.d(t,{I:function(){return a}});var o=r(65736);function a(e){return[e.country,e.state,e.name||(0,o.__)("TAX","woocommerce-admin"),e.priority].map((e=>e.toString().toUpperCase().trim())).filter(Boolean).join("-")}},63193:function(e,t,r){r.d(t,{FI:function(){return y},V1:function(){return g},YC:function(){return u},hQ:function(){return p},jk:function(){return _},oC:function(){return f},qc:function(){return d},uC:function(){return h}});var o=r(96483),a=r(86989),n=r.n(a),i=r(92819),l=r(10431),c=r(67221),m=r(61681),s=r(4411);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.identity;return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;const i="function"==typeof e?e(a):e,c=(0,l.getIdsFromQuery)(r);if(c.length<1)return Promise.resolve([]);const m={include:c.join(","),per_page:c.length};return n()({path:(0,o.addQueryArgs)(i,m)}).then((e=>e.map(t)))}}d(c.NAMESPACE+"/products/attributes",(e=>({key:e.id,label:e.name})));const u=d(c.NAMESPACE+"/products/categories",(e=>({key:e.id,label:e.name}))),p=d(c.NAMESPACE+"/coupons",(e=>({key:e.id,label:e.code}))),_=d(c.NAMESPACE+"/customers",(e=>({key:e.id,label:e.name}))),f=d(c.NAMESPACE+"/products",(e=>({key:e.id,label:e.name}))),y=d(c.NAMESPACE+"/taxes",(e=>({key:e.id,label:(0,m.I)(e)})));function g(e){let{attributes:t,name:r}=e;const o=(0,s.O3)("variationTitleAttributesSeparator"," - ");if(r&&r.indexOf(o)>-1)return r;const a=(t||[]).map((e=>{let{option:t}=e;return t})).join(", ");return a?r+o+a:r}const h=d((e=>{let{products:t}=e;return t?c.NAMESPACE+`/products/${t}/variations`:c.NAMESPACE+"/variations"}),(e=>({key:e.id,label:g(e)})))}}]);