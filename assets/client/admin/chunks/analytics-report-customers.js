"use strict";(self.webpackChunk_wcAdmin_webpackJsonp=self.webpackChunk_wcAdmin_webpackJsonp||[]).push([[3700],{99144:function(e,o,r){r.r(o),r.d(o,{default:function(){return A}});var t=r(69307),a=r(7862),m=r.n(a),l=r(65736),c=r(22629),n=r(92694),i=r(9818),s=r(67221),u=r(63193);const d=(0,n.applyFilters)("woocommerce_admin_customers_report_filters",[{label:(0,l.__)("Show","woocommerce-admin"),staticParams:["paged","per_page"],param:"filter",showFilters:()=>!0,filters:[{label:(0,l.__)("All Customers","woocommerce-admin"),value:"all"},{label:(0,l.__)("Single Customer","woocommerce-admin"),value:"select_customer",chartMode:"item-comparison",subFilters:[{component:"Search",value:"single_customer",chartMode:"item-comparison",path:["select_customer"],settings:{type:"customers",param:"customers",getLabels:u.jk,labels:{placeholder:(0,l.__)("Type to search for a customer","woocommerce-admin"),button:(0,l.__)("Single Customer","woocommerce-admin")}}}]},{label:(0,l.__)("Advanced filters","woocommerce-admin"),value:"advanced"}]}]),_=(0,n.applyFilters)("woocommerce_admin_customers_report_advanced_filters",{title:(0,l._x)("Customers match {{select /}} filters","A sentence describing filters for Customers. See screen shot for context: https://cloudup.com/cCsm3GeXJbE","woocommerce-admin"),filters:{name:{labels:{add:(0,l.__)("Name","woocommerce-admin"),placeholder:(0,l.__)("Search","woocommerce-admin"),remove:(0,l.__)("Remove customer name filter","woocommerce-admin"),rule:(0,l.__)("Select a customer name filter match","woocommerce-admin"),title:(0,l.__)("{{title}}Name{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,l.__)("Select customer name","woocommerce-admin")},rules:[{value:"includes",label:(0,l._x)("Includes","customer names","woocommerce-admin")},{value:"excludes",label:(0,l._x)("Excludes","customer names","woocommerce-admin")}],input:{component:"Search",type:"customers",getLabels:(0,u.qc)(s.NAMESPACE+"/customers",(e=>({id:e.id,label:e.name})))}},country:{labels:{add:(0,l.__)("Country / Region","woocommerce-admin"),placeholder:(0,l.__)("Search","woocommerce-admin"),remove:(0,l.__)("Remove country / region filter","woocommerce-admin"),rule:(0,l.__)("Select a country / region filter match","woocommerce-admin"),title:(0,l.__)("{{title}}Country / Region{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,l.__)("Select country / region","woocommerce-admin")},rules:[{value:"includes",label:(0,l._x)("Includes","countries","woocommerce-admin")},{value:"excludes",label:(0,l._x)("Excludes","countries","woocommerce-admin")}],input:{component:"Search",type:"countries",getLabels:async e=>{const o=(await(0,i.resolveSelect)(s.COUNTRIES_STORE_NAME).getCountries()).map((e=>({key:e.code,label:(0,c.decodeEntities)(e.name)}))),r=e.split(",");return await o.filter((e=>r.includes(e.key)))}}},username:{labels:{add:(0,l.__)("Username","woocommerce-admin"),placeholder:(0,l.__)("Search customer username","woocommerce-admin"),remove:(0,l.__)("Remove customer username filter","woocommerce-admin"),rule:(0,l.__)("Select a customer username filter match","woocommerce-admin"),title:(0,l.__)("{{title}}Username{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,l.__)("Select customer username","woocommerce-admin")},rules:[{value:"includes",label:(0,l._x)("Includes","customer usernames","woocommerce-admin")},{value:"excludes",label:(0,l._x)("Excludes","customer usernames","woocommerce-admin")}],input:{component:"Search",type:"usernames",getLabels:u.jk}},email:{labels:{add:(0,l.__)("Email","woocommerce-admin"),placeholder:(0,l.__)("Search customer email","woocommerce-admin"),remove:(0,l.__)("Remove customer email filter","woocommerce-admin"),rule:(0,l.__)("Select a customer email filter match","woocommerce-admin"),title:(0,l.__)("{{title}}Email{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,l.__)("Select customer email","woocommerce-admin")},rules:[{value:"includes",label:(0,l._x)("Includes","customer emails","woocommerce-admin")},{value:"excludes",label:(0,l._x)("Excludes","customer emails","woocommerce-admin")}],input:{component:"Search",type:"emails",getLabels:(0,u.qc)(s.NAMESPACE+"/customers",(e=>({id:e.id,label:e.email})))}},orders_count:{labels:{add:(0,l.__)("No. of Orders","woocommerce-admin"),remove:(0,l.__)("Remove order filter","woocommerce-admin"),rule:(0,l.__)("Select an order count filter match","woocommerce-admin"),title:(0,l.__)("{{title}}No. of Orders{{/title}} {{rule /}} {{filter /}}","woocommerce-admin")},rules:[{value:"max",label:(0,l._x)("Less Than","number of orders","woocommerce-admin")},{value:"min",label:(0,l._x)("More Than","number of orders","woocommerce-admin")},{value:"between",label:(0,l._x)("Between","number of orders","woocommerce-admin")}],input:{component:"Number"}},total_spend:{labels:{add:(0,l.__)("Total Spend","woocommerce-admin"),remove:(0,l.__)("Remove total spend filter","woocommerce-admin"),rule:(0,l.__)("Select a total spend filter match","woocommerce-admin"),title:(0,l.__)("{{title}}Total Spend{{/title}} {{rule /}} {{filter /}}","woocommerce-admin")},rules:[{value:"max",label:(0,l._x)("Less Than","total spend by customer","woocommerce-admin")},{value:"min",label:(0,l._x)("More Than","total spend by customer","woocommerce-admin")},{value:"between",label:(0,l._x)("Between","total spend by customer","woocommerce-admin")}],input:{component:"Currency"}},avg_order_value:{labels:{add:(0,l.__)("AOV","woocommerce-admin"),remove:(0,l.__)("Remove average order value filter","woocommerce-admin"),rule:(0,l.__)("Select an average order value filter match","woocommerce-admin"),title:(0,l.__)("{{title}}AOV{{/title}} {{rule /}} {{filter /}}","woocommerce-admin")},rules:[{value:"max",label:(0,l._x)("Less Than","average order value of customer","woocommerce-admin")},{value:"min",label:(0,l._x)("More Than","average order value of customer","woocommerce-admin")},{value:"between",label:(0,l._x)("Between","average order value of customer","woocommerce-admin")}],input:{component:"Currency"}},registered:{labels:{add:(0,l.__)("Registered","woocommerce-admin"),remove:(0,l.__)("Remove registered filter","woocommerce-admin"),rule:(0,l.__)("Select a registered filter match","woocommerce-admin"),title:(0,l.__)("{{title}}Registered{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,l.__)("Select registered date","woocommerce-admin")},rules:[{value:"before",label:(0,l._x)("Before","date","woocommerce-admin")},{value:"after",label:(0,l._x)("After","date","woocommerce-admin")},{value:"between",label:(0,l._x)("Between","date","woocommerce-admin")}],input:{component:"Date"}},last_active:{labels:{add:(0,l.__)("Last active","woocommerce-admin"),remove:(0,l.__)("Remove last active filter","woocommerce-admin"),rule:(0,l.__)("Select a last active filter match","woocommerce-admin"),title:(0,l.__)("{{title}}Last active{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:(0,l.__)("Select registered date","woocommerce-admin")},rules:[{value:"before",label:(0,l._x)("Before","date","woocommerce-admin")},{value:"after",label:(0,l._x)("After","date","woocommerce-admin")},{value:"between",label:(0,l._x)("Between","date","woocommerce-admin")}],input:{component:"Date"}}}});var v=r(55609),p=r(86020),w=r(81595),b=r(74617),f=r(81921),y=r(13732),g=r(83199),h=r(4411),S=function(e){let{isRequesting:o,query:r,filters:a,advancedFilters:m}=e;const c=(0,t.useContext)(g.$),{countries:n,loadingCountries:u}=(0,i.useSelect)((e=>{const{getCountries:o,hasFinishedResolution:r}=e(s.COUNTRIES_STORE_NAME);return{countries:o(),loadingCountries:!r("getCountries")}}));return(0,t.createElement)(y.Z,{endpoint:"customers",getHeadersContent:()=>[{label:(0,l.__)("Name","woocommerce-admin"),key:"name",required:!0,isLeftAligned:!0,isSortable:!0},{label:(0,l.__)("Username","woocommerce-admin"),key:"username",hiddenByDefault:!0},{label:(0,l.__)("Last active","woocommerce-admin"),key:"date_last_active",defaultSort:!0,isSortable:!0},{label:(0,l.__)("Date registered","woocommerce-admin"),key:"date_registered",isSortable:!0},{label:(0,l.__)("Email","woocommerce-admin"),key:"email"},{label:(0,l.__)("Orders","woocommerce-admin"),key:"orders_count",isSortable:!0,isNumeric:!0},{label:(0,l.__)("Total spend","woocommerce-admin"),key:"total_spend",isSortable:!0,isNumeric:!0},{label:(0,l.__)("AOV","woocommerce-admin"),screenReaderLabel:(0,l.__)("Average order value","woocommerce-admin"),key:"avg_order_value",isNumeric:!0},{label:(0,l.__)("Country / Region","woocommerce-admin"),key:"country",isSortable:!0},{label:(0,l.__)("City","woocommerce-admin"),key:"city",hiddenByDefault:!0,isSortable:!0},{label:(0,l.__)("Region","woocommerce-admin"),key:"state",hiddenByDefault:!0,isSortable:!0},{label:(0,l.__)("Postal code","woocommerce-admin"),key:"postcode",hiddenByDefault:!0,isSortable:!0}],getRowsContent:e=>{const o=(0,h.O3)("dateFormat",f.defaultTableDateFormat),{formatAmount:r,formatDecimal:a,getCurrencyConfig:m}=c;return null==e?void 0:e.map((e=>{const{avg_order_value:l,date_last_active:c,date_registered:i,email:s,name:u,user_id:d,orders_count:_,username:f,total_spend:y,postcode:g,city:h,state:S,country:E}=e,A=void 0!==n[C=E]?n[C]:null;var C;const x=d?(0,t.createElement)(p.Link,{href:(0,b.getAdminLink)("user-edit.php?user_id="+d),type:"wp-admin"},u):u,k=c?(0,t.createElement)(p.Date,{date:c,visibleFormat:o}):"—",R=i?(0,t.createElement)(p.Date,{date:i,visibleFormat:o}):"—",N=(0,t.createElement)(t.Fragment,null,(0,t.createElement)(v.Tooltip,{text:A},(0,t.createElement)("span",{"aria-hidden":"true"},E)),(0,t.createElement)("span",{className:"screen-reader-text"},A));return[{display:x,value:u},{display:f,value:f},{display:k,value:c},{display:R,value:i},{display:(0,t.createElement)("a",{href:"mailto:"+s},s),value:s},{display:(0,w.formatValue)(m(),"number",_),value:_},{display:r(y),value:a(y)},{display:r(l),value:a(l)},{display:N,value:E},{display:h,value:h},{display:S,value:S},{display:g,value:g}]}))},getSummary:e=>{const{customers_count:o=0,avg_orders_count:r=0,avg_total_spend:t=0,avg_avg_order_value:a=0}=e,{formatAmount:m,getCurrencyConfig:n}=c,i=n();return[{label:(0,l._n)("customer","customers",o,"woocommerce-admin"),value:(0,w.formatValue)(i,"number",o)},{label:(0,l._n)("Average order","Average orders",r,"woocommerce-admin"),value:(0,w.formatValue)(i,"number",r)},{label:(0,l.__)("Average lifetime spend","woocommerce-admin"),value:m(t)},{label:(0,l.__)("Average order value","woocommerce-admin"),value:m(a)}]},summaryFields:["customers_count","avg_orders_count","avg_total_spend","avg_avg_order_value"],isRequesting:o||u,itemIdField:"id",query:r,labels:{placeholder:(0,l.__)("Search by customer name","woocommerce-admin")},searchBy:"customers",title:(0,l.__)("Customers","woocommerce-admin"),columnPrefsKey:"customers_report_columns",filters:a,advancedFilters:m})},E=r(25619);class A extends t.Component{render(){const{isRequesting:e,query:o,path:r}=this.props,a={orderby:"date_last_active",order:"desc",...o};return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(E.Z,{query:o,path:r,filters:d,showDatePicker:!1,advancedFilters:_,report:"customers"}),(0,t.createElement)(S,{isRequesting:e,query:a,filters:d,advancedFilters:_}))}}A.propTypes={query:m().object.isRequired}},61681:function(e,o,r){r.d(o,{I:function(){return a}});var t=r(65736);function a(e){return[e.country,e.state,e.name||(0,t.__)("TAX","woocommerce-admin"),e.priority].map((e=>e.toString().toUpperCase().trim())).filter(Boolean).join("-")}},63193:function(e,o,r){r.d(o,{FI:function(){return w},V1:function(){return b},YC:function(){return d},hQ:function(){return _},jk:function(){return v},oC:function(){return p},qc:function(){return u},uC:function(){return f}});var t=r(96483),a=r(86989),m=r.n(a),l=r(92819),c=r(10431),n=r(67221),i=r(61681),s=r(4411);function u(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.identity;return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;const l="function"==typeof e?e(a):e,n=(0,c.getIdsFromQuery)(r);if(n.length<1)return Promise.resolve([]);const i={include:n.join(","),per_page:n.length};return m()({path:(0,t.addQueryArgs)(l,i)}).then((e=>e.map(o)))}}u(n.NAMESPACE+"/products/attributes",(e=>({key:e.id,label:e.name})));const d=u(n.NAMESPACE+"/products/categories",(e=>({key:e.id,label:e.name}))),_=u(n.NAMESPACE+"/coupons",(e=>({key:e.id,label:e.code}))),v=u(n.NAMESPACE+"/customers",(e=>({key:e.id,label:e.name}))),p=u(n.NAMESPACE+"/products",(e=>({key:e.id,label:e.name}))),w=u(n.NAMESPACE+"/taxes",(e=>({key:e.id,label:(0,i.I)(e)})));function b(e){let{attributes:o,name:r}=e;const t=(0,s.O3)("variationTitleAttributesSeparator"," - ");if(r&&r.indexOf(t)>-1)return r;const a=(o||[]).map((e=>{let{option:o}=e;return o})).join(", ");return a?r+t+a:r}const f=u((e=>{let{products:o}=e;return o?n.NAMESPACE+`/products/${o}/variations`:n.NAMESPACE+"/variations"}),(e=>({key:e.id,label:b(e)})))}}]);