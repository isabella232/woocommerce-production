"use strict";(self.webpackChunk_wcAdmin_webpackJsonp=self.webpackChunk_wcAdmin_webpackJsonp||[]).push([[6147,7108],{42943:function(e,t,s){s.r(t),s.d(t,{TaskList:function(){return E},default:function(){return w}});var o=s(5267),a=s(69307),n=s(65736),c=s(55609),i=s(9818),l=s(86020),r=s(67221),m=s(14599),d=s(14812),k=s(10431),_=s(79298);const u=e=>{var t;let{isExpandable:s=!1,isExpanded:c=!1,setExpandedTask:l,task:u}=e;const{createNotice:p}=(0,i.useDispatch)("core/notices"),{dismissTask:E,snoozeTask:w,undoDismissTask:h,undoSnoozeTask:b}=(0,i.useDispatch)(r.ONBOARDING_STORE_NAME),f=(0,r.useUserPreferences)(),{actionLabel:C,actionUrl:v,content:T,id:N,isComplete:g,isDismissable:x,isSnoozeable:S,time:D,title:I,level:O,additionalInfo:L}=u,z=(0,d.useSlot)(`woocommerce_onboarding_task_list_item_${N}`),A=Boolean(null==z||null===(t=z.fills)||void 0===t?void 0:t.length),R=(0,a.useCallback)((()=>{E(N),p("success",(0,n.__)("Task dismissed"),{actions:[{label:(0,n.__)("Undo","woocommerce-admin"),onClick:()=>h(N)}]})}),[N]),B=(0,a.useCallback)((()=>{w(N),p("success",(0,n.__)("Task postponed until tomorrow","woocommerce-admin"),{actions:[{label:(0,n.__)("Undo","woocommerce-admin"),onClick:()=>b(N)}]})}),[N]),P=(0,a.useCallback)((()=>{v?v.startsWith("http")?window.location.href=v:(0,k.getHistory)().push((0,k.getNewPath)({},v,{})):(window.document.documentElement.scrollTop=0,(0,k.updateQueryString)({task:N}))}),[N,g,v]),U={expandable:s,expanded:s&&c,completed:g,onSnooze:S&&B,onDismiss:x&&R},y=(0,a.useCallback)((e=>{const t=()=>((0,m.recordEvent)("tasklist_click",{task_name:N}),g||(()=>{const e=(()=>{const e=f.task_list_tracked_started_tasks;return e&&e[N]?e[N]:0})()+1,t=f.task_list_tracked_started_tasks||{};f.updateUserPreferences({task_list_tracked_started_tasks:{...t||{},[N]:e}})})(),e.onClick?e.onClick():P());return(0,a.createElement)(d.TaskItem,(0,o.Z)({key:N,title:I,content:T,additionalInfo:L,time:D,action:t,level:O,actionLabel:C},U,e,{onClick:!s||g?t:()=>l(N)}))}),[N,I,T,D,C,s,g]);return A?(0,a.createElement)(_.WooOnboardingTaskListItem.Slot,{id:N,fillProps:{defaultTaskItem:y,isComplete:g,...U}}):(0,a.createElement)(y,{onClick:u.onClick})},p=e=>{let{id:t}=e;const{hideTaskList:s}=(0,i.useDispatch)(r.ONBOARDING_STORE_NAME);return(0,a.createElement)("div",{className:"woocommerce-card__menu woocommerce-card__header-item"},(0,a.createElement)(l.EllipsisMenu,{label:(0,n.__)("Task List Options","woocommerce-admin"),renderContent:()=>(0,a.createElement)("div",{className:"woocommerce-task-card__section-controls"},(0,a.createElement)(c.Button,{onClick:()=>s(t)},(0,n.__)("Hide this","woocommerce-admin")))}))},E=e=>{var t;let{id:s,eventPrefix:k,tasks:_,title:E,isCollapsible:w=!1,isExpandable:h=!1,query:b}=e;const{profileItems:f}=(0,i.useSelect)((e=>{const{getProfileItems:t}=e(r.ONBOARDING_STORE_NAME);return{profileItems:t()}})),C=(0,a.useRef)(b),v=Date.now(),T=_.filter((e=>!e.isDismissed&&(!e.isSnoozed||e.snoozedUntil<v))),N=_.filter((e=>!e.isComplete&&!e.isDismissed)),[g,x]=(0,a.useState)(null===(t=N[0])||void 0===t?void 0:t.id);if((0,a.useEffect)((()=>{(0,m.recordEvent)(k+"view",{number_tasks:T.length,store_connected:f.wccom_connected})}),[]),(0,a.useEffect)((()=>{const{task:e}=C.current,{task:t}=b;e!==t&&(window.document.documentElement.scrollTop=0,C.current=b)}),[b]),!T.length)return(0,a.createElement)("div",{className:"woocommerce-task-dashboard__container"});const S=(0,n.sprintf)((0,n._n)("Show %d more task.","Show %d more tasks.",T.length-2,"woocommerce-admin"),T.length-2),D=(0,n.__)("Show less","woocommerce-admin"),I=w?d.CollapsibleList:d.List,O=w?{collapseLabel:D,expandLabel:S,show:2,onCollapse:()=>(0,m.recordEvent)(k+"collapse",{}),onExpand:()=>(0,m.recordEvent)(k+"expand",{})}:{};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"woocommerce-task-dashboard__container woocommerce-task-list__"+s},(0,a.createElement)(c.Card,{size:"large",className:"woocommerce-task-card woocommerce-homescreen-card"},(0,a.createElement)(c.CardHeader,{size:"medium"},(0,a.createElement)("div",{className:"wooocommerce-task-card__header"},(0,a.createElement)(d.Text,{size:"20",lineHeight:"28px",variant:"title.small"},E),(0,a.createElement)(l.Badge,{count:N.length})),(0,a.createElement)(p,{id:s})),(0,a.createElement)(I,(0,o.Z)({animation:"custom"},O),T.map((e=>(0,a.createElement)(u,{key:e.id,isExpanded:g===e.id,isExpandable:h,task:e,setExpandedTask:x})))))))};var w=E}}]);